{{- $buttonText := .Get "text" | default "Open" -}}
{{- $icon := .Get "icon" | default "feather-file" -}}
{{- $contentPath := .Get "content" -}}
{{- $modalId := .Get "id" | default (printf "modal-%s" ($contentPath | urlize)) -}}
{{- $title := .Get "title" | default "Content" -}}

{{- if not $contentPath -}}
  {{- errorf "modal-button shortcode requires 'content' parameter" -}}
{{- end -}}

<button class="modal-trigger-btn" data-modal-id="{{ $modalId }}" data-content-path="{{ $contentPath }}" title="{{ $buttonText }}">
  {{- if eq $icon "feather-zap" -}}
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-zap"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>
  {{- else if eq $icon "feather-file" -}}
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
  {{- else if eq $icon "feather-info" -}}
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-info"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
  {{- else if eq $icon "feather-book" -}}
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-book"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
  {{- else -}}
  {{ $icon }}
  {{- end -}}
  <span class="modal-btn-text">{{ $buttonText }}</span>
</button>

<div id="{{ $modalId }}" class="features-modal modal-shortcode">
  <div class="features-modal-content">
    <div class="features-modal-header">
      <h2>{{ $title }}</h2>
      <button class="features-close modal-close-btn" data-modal-id="{{ $modalId }}">&times;</button>
    </div>
    <div class="modal-body-container" data-content-path="{{ $contentPath }}">
      <div class="features-loading">Loading...</div>
    </div>
  </div>
</div>
